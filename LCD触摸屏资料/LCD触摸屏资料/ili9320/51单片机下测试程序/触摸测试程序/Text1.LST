C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE TEXT1
OBJECT MODULE PLACED IN Text1.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Text1.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <reg51.h>
   2          #include <intrins.h>
   3          
   4          /* http://ttmcu.taobao.com 雨亭电子程
   5          代码测试环境:JME-2核心板+1T指令周期的STC单片机（51内核STC12LE5A60S2)+33M晶振      单片机工作电压3.3V
   6          程序默认IO连接方式
   7          控制线：RS-P3^5;    WR-P3^6;   RD-P3^7;   CS-P1^0;   REST-P1^2;
   8          数据线: DB0-DB7依次连接P0^1-P0^7;  DB8-DB15依次连接P2^1-P2^7;（8位模式下DB8-DB15可以不连接）
   9          */
  10          #define Bus_16        //16位数据模式,如果使用8位模式，请注释此语句，如果使用16位模式，请打开此句
  11          #define  LCD_DataPortH P2     //高8位数据口,8位模式下只使用高8位 
  12          #define  LCD_DataPortL P0     //低8位数据口     ,8位模式下低8位可以不接线
  13          sbit LCD_RS = P3^5;              //数据/命令切换
  14          sbit LCD_WR = P3^6;               //写控制
  15          sbit LCD_RD =P3^7;                   //读控制
  16          sbit LCD_CS=P1^0;               //片选  
  17          sbit LCD_REST = P1^2;         //复位   
  18          
  19          /* touch panel interface define */
  20          sbit DCLK          =    P1^7;
  21          sbit CS        =    P1^4;
  22          sbit DIN       =    P3^0;       
  23          sbit DOUT      =    P3^1;                                                                                                                                                                                  
  24          sbit IRQ       =    P3^4;   //检测触摸屏响应信号
  25          unsigned int TP_X,TP_Y;    //当前触控坐标
  26          
  27          //8*12字符
  28          unsigned char code zifu[]={         
  29          /*--  文字:     --*/
  30          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  31          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  32          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  33          
  34          /*--  文字:  !  --*/
  35          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  36          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  37          0x00,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0x20,0x00,0x00,
  38          
  39          /*--  文字:  "  --*/
  40          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  41          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  42          0x00,0x28,0x50,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  43          
  44          /*--  文字:  #  --*/
  45          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  46          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  47          0x00,0x00,0x28,0x28,0xFC,0x28,0x50,0xFC,0x50,0x50,0x00,0x00,
  48          
  49          /*--  文字:  $  --*/
  50          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  51          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  52          0x00,0x20,0x78,0xA8,0xA0,0x60,0x30,0x28,0xA8,0xF0,0x20,0x00,
  53          
  54          /*--  文字:  %  --*/
  55          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 2   

  56          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  57          0x00,0x00,0x48,0xA8,0xB0,0x50,0x28,0x34,0x54,0x48,0x00,0x00,
  58          
  59          /*--  文字:  &  --*/
  60          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  61          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  62          0x00,0x00,0x20,0x50,0x50,0x78,0xA8,0xA8,0x90,0x6C,0x00,0x00,
  63          
  64          /*--  文字:  '  --*/
  65          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  66          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  67          0x00,0x40,0x40,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  68          
  69          /*--  文字:  (  --*/
  70          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  71          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  72          0x00,0x04,0x08,0x10,0x10,0x10,0x10,0x10,0x10,0x08,0x04,0x00,
  73          
  74          /*--  文字:  )  --*/
  75          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  76          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  77          0x00,0x40,0x20,0x10,0x10,0x10,0x10,0x10,0x10,0x20,0x40,0x00,
  78          
  79          /*--  文字:  *  --*/
  80          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  81          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  82          0x00,0x00,0x00,0x20,0xA8,0x70,0x70,0xA8,0x20,0x00,0x00,0x00,
  83          
  84          /*--  文字:  +  --*/
  85          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  86          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  87          0x00,0x00,0x20,0x20,0x20,0xF8,0x20,0x20,0x20,0x00,0x00,0x00,
  88          
  89          /*--  文字:  ,  --*/
  90          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  91          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  92          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x40,0x80,
  93          
  94          /*--  文字:  -  --*/
  95          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
  96          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
  97          0x00,0x00,0x00,0x00,0x00,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,
  98          
  99          /*--  文字:  .  --*/
 100          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 101          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 102          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,
 103          
 104          /*--  文字:  /  --*/
 105          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 106          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 107          0x00,0x08,0x10,0x10,0x10,0x20,0x20,0x40,0x40,0x40,0x80,0x00,
 108          
 109          /*--  文字:  0  --*/
 110          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 111          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 112          0x00,0x00,0x70,0x88,0x88,0x88,0x88,0x88,0x88,0x70,0x00,0x00,
 113          
 114          /*--  文字:  1  --*/
 115          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 116          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 117          0x00,0x00,0x20,0x60,0x20,0x20,0x20,0x20,0x20,0x70,0x00,0x00,
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 3   

 118          
 119          /*--  文字:  2  --*/
 120          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 121          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 122          0x00,0x00,0x70,0x88,0x88,0x10,0x20,0x40,0x80,0xF8,0x00,0x00,
 123          
 124          /*--  文字:  3  --*/
 125          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 126          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 127          0x00,0x00,0x70,0x88,0x08,0x30,0x08,0x08,0x88,0x70,0x00,0x00,
 128          
 129          /*--  文字:  4  --*/
 130          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 131          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 132          0x00,0x00,0x10,0x30,0x50,0x50,0x90,0x78,0x10,0x18,0x00,0x00,
 133          
 134          /*--  文字:  5  --*/
 135          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 136          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 137          0x00,0x00,0xF8,0x80,0x80,0xF0,0x08,0x08,0x88,0x70,0x00,0x00,
 138          
 139          /*--  文字:  6  --*/
 140          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 141          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 142          0x00,0x00,0x70,0x90,0x80,0xF0,0x88,0x88,0x88,0x70,0x00,0x00,
 143          
 144          /*--  文字:  7  --*/
 145          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 146          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 147          0x00,0x00,0xF8,0x90,0x10,0x20,0x20,0x20,0x20,0x20,0x00,0x00,
 148          
 149          /*--  文字:  8  --*/
 150          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 151          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 152          0x00,0x00,0x70,0x88,0x88,0x70,0x88,0x88,0x88,0x70,0x00,0x00,
 153          
 154          /*--  文字:  9  --*/
 155          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 156          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 157          0x00,0x00,0x70,0x88,0x88,0x88,0x78,0x08,0x48,0x70,0x00,0x00,
 158          
 159          /*--  文字:  :  --*/
 160          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 161          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 162          0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x20,0x00,0x00,
 163          
 164          /*--  文字:  ;  --*/
 165          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 166          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 167          0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x20,0x20,0x00,
 168          
 169          /*--  文字:  <  --*/
 170          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 171          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 172          0x00,0x04,0x08,0x10,0x20,0x40,0x20,0x10,0x08,0x04,0x00,0x00,
 173          
 174          /*--  文字:  =  --*/
 175          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 176          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 177          0x00,0x00,0x00,0x00,0xF8,0x00,0x00,0xF8,0x00,0x00,0x00,0x00,
 178          
 179          /*--  文字:  >  --*/
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 4   

 180          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 181          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 182          0x00,0x40,0x20,0x10,0x08,0x04,0x08,0x10,0x20,0x40,0x00,0x00,
 183          
 184          /*--  文字:  ?  --*/
 185          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 186          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 187          0x00,0x00,0x70,0x88,0x88,0x10,0x20,0x20,0x00,0x20,0x00,0x00,
 188          
 189          /*--  文字:  @  --*/
 190          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 191          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 192          0x00,0x00,0x70,0x88,0x98,0xA8,0xA8,0xB8,0x80,0x78,0x00,0x00,
 193          
 194          /*--  文字:  A  --*/
 195          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 196          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 197          0x00,0x00,0x20,0x20,0x30,0x50,0x50,0x78,0x48,0xCC,0x00,0x00,
 198          
 199          /*--  文字:  B  --*/
 200          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 201          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 202          0x00,0x00,0xF0,0x48,0x48,0x70,0x48,0x48,0x48,0xF0,0x00,0x00,
 203          
 204          /*--  文字:  C  --*/
 205          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 206          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 207          0x00,0x00,0x78,0x88,0x80,0x80,0x80,0x80,0x88,0x70,0x00,0x00,
 208          
 209          /*--  文字:  D  --*/
 210          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 211          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 212          0x00,0x00,0xF0,0x48,0x48,0x48,0x48,0x48,0x48,0xF0,0x00,0x00,
 213          
 214          /*--  文字:  E  --*/
 215          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 216          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 217          0x00,0x00,0xF8,0x48,0x50,0x70,0x50,0x40,0x48,0xF8,0x00,0x00,
 218          
 219          /*--  文字:  F  --*/
 220          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 221          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 222          0x00,0x00,0xF8,0x48,0x50,0x70,0x50,0x40,0x40,0xE0,0x00,0x00,
 223          
 224          /*--  文字:  G  --*/
 225          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 226          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 227          0x00,0x00,0x38,0x48,0x80,0x80,0x9C,0x88,0x48,0x30,0x00,0x00,
 228          
 229          /*--  文字:  H  --*/
 230          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 231          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 232          0x00,0x00,0xCC,0x48,0x48,0x78,0x48,0x48,0x48,0xCC,0x00,0x00,
 233          
 234          /*--  文字:  I  --*/
 235          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 236          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 237          0x00,0x00,0xF8,0x20,0x20,0x20,0x20,0x20,0x20,0xF8,0x00,0x00,
 238          
 239          /*--  文字:  J  --*/
 240          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 241          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 5   

 242          0x00,0x00,0x7C,0x10,0x10,0x10,0x10,0x10,0x10,0x90,0xE0,0x00,
 243          
 244          /*--  文字:  K  --*/
 245          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 246          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 247          0x00,0x00,0xEC,0x48,0x50,0x60,0x50,0x50,0x48,0xEC,0x00,0x00,
 248          
 249          /*--  文字:  L  --*/
 250          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 251          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 252          0x00,0x00,0xE0,0x40,0x40,0x40,0x40,0x40,0x44,0xFC,0x00,0x00,
 253          
 254          /*--  文字:  M  --*/
 255          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 256          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 257          0x00,0x00,0xD8,0xD8,0xD8,0xD8,0xA8,0xA8,0xA8,0xA8,0x00,0x00,
 258          
 259          /*--  文字:  N  --*/
 260          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 261          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 262          0x00,0x00,0xDC,0x48,0x68,0x68,0x58,0x58,0x48,0xE8,0x00,0x00,
 263          
 264          /*--  文字:  O  --*/
 265          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 266          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 267          0x00,0x00,0x70,0x88,0x88,0x88,0x88,0x88,0x88,0x70,0x00,0x00,
 268          
 269          /*--  文字:  P  --*/
 270          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 271          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 272          0x00,0x00,0xF0,0x48,0x48,0x70,0x40,0x40,0x40,0xE0,0x00,0x00,
 273          
 274          /*--  文字:  Q  --*/
 275          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 276          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 277          0x00,0x00,0x70,0x88,0x88,0x88,0x88,0xE8,0x98,0x70,0x18,0x00,
 278          
 279          /*--  文字:  R  --*/
 280          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 281          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 282          0x00,0x00,0xF0,0x48,0x48,0x70,0x50,0x48,0x48,0xEC,0x00,0x00,
 283          
 284          /*--  文字:  S  --*/
 285          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 286          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 287          0x00,0x00,0x78,0x88,0x80,0x60,0x10,0x08,0x88,0xF0,0x00,0x00,
 288          
 289          /*--  文字:  T  --*/
 290          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 291          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 292          0x00,0x00,0xF8,0xA8,0x20,0x20,0x20,0x20,0x20,0x70,0x00,0x00,
 293          
 294          /*--  文字:  U  --*/
 295          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 296          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 297          0x00,0x00,0xCC,0x48,0x48,0x48,0x48,0x48,0x48,0x30,0x00,0x00,
 298          
 299          /*--  文字:  V  --*/
 300          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 301          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 302          0x00,0x00,0xCC,0x48,0x48,0x50,0x50,0x30,0x20,0x20,0x00,0x00,
 303          
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 6   

 304          /*--  文字:  W  --*/
 305          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 306          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 307          0x00,0x00,0xA8,0xA8,0xA8,0x70,0x50,0x50,0x50,0x50,0x00,0x00,
 308          
 309          /*--  文字:  X  --*/
 310          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 311          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 312          0x00,0x00,0xD8,0x50,0x50,0x20,0x20,0x50,0x50,0xD8,0x00,0x00,
 313          
 314          /*--  文字:  Y  --*/
 315          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 316          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 317          0x00,0x00,0xD8,0x50,0x50,0x20,0x20,0x20,0x20,0x70,0x00,0x00,
 318          
 319          /*--  文字:  Z  --*/
 320          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 321          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 322          0x00,0x00,0xF8,0x90,0x10,0x20,0x20,0x40,0x48,0xF8,0x00,0x00,
 323          
 324          /*--  文字:  [  --*/
 325          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 326          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 327          0x00,0x38,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x38,0x00,
 328          
 329          /*--  文字:  \  --*/
 330          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 331          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 332          0x00,0x40,0x40,0x40,0x20,0x20,0x10,0x10,0x10,0x08,0x00,0x00,
 333          
 334          /*--  文字:  ]  --*/
 335          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 336          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 337          0x00,0x70,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x70,0x00,
 338          
 339          /*--  文字:  ^  --*/
 340          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 341          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 342          0x00,0x20,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
 343          
 344          /*--  文字:  _  --*/
 345          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 346          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 347          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,
 348          
 349          /*--  文字:  `  --*/
 350          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 351          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 352          0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
 353          
 354          /*--  文字:  a  --*/
 355          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 356          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 357          0x00,0x00,0x00,0x00,0x00,0x30,0x48,0x38,0x48,0x3C,0x00,0x00,
 358          
 359          /*--  文字:  b  --*/
 360          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 361          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 362          0x00,0x00,0xC0,0x40,0x40,0x70,0x48,0x48,0x48,0x70,0x00,0x00,
 363          
 364          /*--  文字:  c  --*/
 365          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 7   

 366          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 367          0x00,0x00,0x00,0x00,0x00,0x38,0x48,0x40,0x40,0x38,0x00,0x00,
 368          
 369          /*--  文字:  d  --*/
 370          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 371          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 372          0x00,0x00,0x18,0x08,0x08,0x38,0x48,0x48,0x48,0x3C,0x00,0x00,
 373          
 374          /*--  文字:  e  --*/
 375          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 376          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 377          0x00,0x00,0x00,0x00,0x00,0x30,0x48,0x78,0x40,0x38,0x00,0x00,
 378          
 379          /*--  文字:  f  --*/
 380          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 381          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 382          0x00,0x00,0x1C,0x20,0x20,0x78,0x20,0x20,0x20,0x78,0x00,0x00,
 383          
 384          /*--  文字:  g  --*/
 385          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 386          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 387          0x00,0x00,0x00,0x00,0x00,0x3C,0x48,0x30,0x40,0x78,0x44,0x38,
 388          
 389          /*--  文字:  h  --*/
 390          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 391          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 392          0x00,0x00,0xC0,0x40,0x40,0x70,0x48,0x48,0x48,0xEC,0x00,0x00,
 393          
 394          /*--  文字:  i  --*/
 395          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 396          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 397          0x00,0x00,0x20,0x00,0x00,0x60,0x20,0x20,0x20,0x70,0x00,0x00,
 398          
 399          /*--  文字:  j  --*/
 400          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 401          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 402          0x00,0x00,0x10,0x00,0x00,0x30,0x10,0x10,0x10,0x10,0x10,0xE0,
 403          
 404          /*--  文字:  k  --*/
 405          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 406          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 407          0x00,0x00,0xC0,0x40,0x40,0x5C,0x50,0x70,0x48,0xEC,0x00,0x00,
 408          
 409          /*--  文字:  l  --*/
 410          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 411          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 412          0x00,0x00,0xE0,0x20,0x20,0x20,0x20,0x20,0x20,0xF8,0x00,0x00,
 413          
 414          /*--  文字:  m  --*/
 415          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 416          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 417          0x00,0x00,0x00,0x00,0x00,0xF0,0xA8,0xA8,0xA8,0xA8,0x00,0x00,
 418          
 419          /*--  文字:  n  --*/
 420          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 421          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 422          0x00,0x00,0x00,0x00,0x00,0xF0,0x48,0x48,0x48,0xEC,0x00,0x00,
 423          
 424          /*--  文字:  o  --*/
 425          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 426          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 427          0x00,0x00,0x00,0x00,0x00,0x30,0x48,0x48,0x48,0x30,0x00,0x00,
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 8   

 428          
 429          /*--  文字:  p  --*/
 430          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 431          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 432          0x00,0x00,0x00,0x00,0x00,0xF0,0x48,0x48,0x48,0x70,0x40,0xE0,
 433          
 434          /*--  文字:  q  --*/
 435          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 436          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 437          0x00,0x00,0x00,0x00,0x00,0x38,0x48,0x48,0x48,0x38,0x08,0x1C,
 438          
 439          /*--  文字:  r  --*/
 440          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 441          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 442          0x00,0x00,0x00,0x00,0x00,0xD8,0x60,0x40,0x40,0xE0,0x00,0x00,
 443          
 444          /*--  文字:  s  --*/
 445          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 446          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 447          0x00,0x00,0x00,0x00,0x00,0x78,0x40,0x30,0x08,0x78,0x00,0x00,
 448          
 449          /*--  文字:  t  --*/
 450          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 451          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 452          0x00,0x00,0x00,0x20,0x20,0x70,0x20,0x20,0x20,0x18,0x00,0x00,
 453          
 454          /*--  文字:  u  --*/
 455          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 456          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 457          0x00,0x00,0x00,0x00,0x00,0xD8,0x48,0x48,0x48,0x3C,0x00,0x00,
 458          
 459          /*--  文字:  v  --*/
 460          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 461          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 462          0x00,0x00,0x00,0x00,0x00,0xEC,0x48,0x50,0x30,0x20,0x00,0x00,
 463          
 464          /*--  文字:  w  --*/
 465          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 466          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 467          0x00,0x00,0x00,0x00,0x00,0xA8,0xA8,0x70,0x50,0x50,0x00,0x00,
 468          
 469          /*--  文字:  x  --*/
 470          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 471          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 472          0x00,0x00,0x00,0x00,0x00,0xD8,0x50,0x20,0x50,0xD8,0x00,0x00,
 473          
 474          /*--  文字:  y  --*/
 475          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 476          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 477          0x00,0x00,0x00,0x00,0x00,0xEC,0x48,0x50,0x30,0x20,0x20,0xC0,
 478          
 479          /*--  文字:  z  --*/
 480          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 481          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 482          0x00,0x00,0x00,0x00,0x00,0x78,0x10,0x20,0x20,0x78,0x00,0x00,
 483          
 484          /*--  文字:  {  --*/
 485          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 486          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 487          0x00,0x18,0x10,0x10,0x10,0x20,0x10,0x10,0x10,0x10,0x18,0x00,
 488          
 489          /*--  文字:  |  --*/
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 9   

 490          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 491          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 492          0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,
 493          
 494          /*--  文字:  }  --*/
 495          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 496          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 497          0x00,0x60,0x20,0x20,0x20,0x10,0x20,0x20,0x20,0x20,0x60,0x00,
 498          
 499          /*--  文字:  ~  --*/
 500          /*--  宋体9;  此字体下对应的点阵为：宽x高=6x12   --*/
 501          /*--  宽度不是8的倍数，现调整为：宽度x高度=8x12  --*/
 502          0x40,0xA4,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
 503          
 504              
 505          };  
 506          
 507          //**********************************************************
 508          void spistar()                                     //SPI开始
 509          {
 510   1      CS=1;
 511   1      DCLK=1;
 512   1      DIN=1;
 513   1      DCLK=1;
 514   1      }
 515          //**********************************************************
 516          void WriteCharTo7843(unsigned char num)          //SPI写数据
 517          {
 518   1      unsigned char count=0;
 519   1      DCLK=0;
 520   1      for(count=0;count<8;count++)
 521   1      {
 522   2      num<<=1;
 523   2      DIN=CY;
 524   2      DCLK=0; _nop_();_nop_();_nop_();                //上升沿有效
 525   2      DCLK=1; _nop_();_nop_();_nop_();
 526   2      }
 527   1      }
 528          //**********************************************************
 529          unsigned int ReadFromCharFrom7843()             //SPI 读数据
 530          {
 531   1      unsigned char count=0;
 532   1      unsigned int Num=0;
 533   1      for(count=0;count<12;count++)
 534   1      {
 535   2      Num<<=1;
 536   2      DCLK=1; _nop_();_nop_();_nop_();                //下降沿有效
 537   2      DCLK=0; _nop_();_nop_();_nop_();
 538   2      if(DOUT) Num++;
 539   2      }
 540   1      return(Num);
 541   1      }
 542          
 543          void delayms(int count)  // /* X1ms */
 544          {
 545   1              int i,j;
 546   1              for(i=0;i<count;i++)
 547   1                      for(j=0;j<1000;j++);
 548   1      }
 549          
 550          #ifdef  Bus_16    //条件编译-16位数据模式   
 551          void LCD_Writ_Bus(char VH,char VL)   //并行数据写入函数
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 10  

 552          {
 553   1          LCD_DataPortH=VH;   
 554   1              LCD_DataPortL=VL;               
 555   1              LCD_WR=0;
 556   1              LCD_WR=1; 
 557   1      }
 558          #else                   //条件编译-8位数据模式 
              void LCD_Writ_Bus(char VH,char VL)   //并行数据写入函数
              {       
                  LCD_DataPortH=VH;   
                      LCD_WR=0;
                      LCD_WR=1;
                      LCD_DataPortH=VL;               
                      LCD_WR=0;
                      LCD_WR=1;
              }
              #endif
 569          
 570          void LCD_Write_COM(char VH,char VL)      //发送命令
 571          {       
 572   1          LCD_RS=0;
 573   1              LCD_Writ_Bus(VH,VL);
 574   1      }
 575          
 576          
 577          void LCD_Write_DATA(char VH,char VL)    //发送数据
 578          {
 579   1          LCD_RS=1;
 580   1              LCD_Writ_Bus(VH,VL);
 581   1      }
 582          
 583          void Address_set(unsigned int x1,unsigned int y1,unsigned int x2,unsigned int y2)
 584          {
 585   1              LCD_Write_COM(0x00,0x20);LCD_Write_DATA(x1>>8,x1);        //设置X坐标位置
 586   1          LCD_Write_COM(0x00,0x21);LCD_Write_DATA(y1>>8,y1);   //设置Y坐标位置
 587   1          LCD_Write_COM(0x00,0x50);LCD_Write_DATA(x1>>8,x1);   //开始X
 588   1              LCD_Write_COM(0x00,0x52);LCD_Write_DATA(y1>>8,y1);        //开始Y
 589   1          LCD_Write_COM(0x00,0x51);LCD_Write_DATA(x2>>8,x2);   //结束X
 590   1              LCD_Write_COM(0x00,0x53);LCD_Write_DATA(y2>>8,y2);   //结束Y
 591   1          LCD_Write_COM(0x00,0x22);                                                    
 592   1      }
 593          
 594          void LCD_Init(void)
 595          {
 596   1      
 597   1              RD=1;
 598   1          LCD_REST=1;
 599   1          delayms(5); 
 600   1              LCD_REST=0;
 601   1              delayms(5);
 602   1              LCD_REST=1;
 603   1              LCD_RD=1;
 604   1              LCD_WR=1;
 605   1              delayms(5);
 606   1      
 607   1      
 608   1              LCD_CS =0;  //打开片选使能
 609   1              //************* Start Initial Sequence **********//
 610   1              LCD_Write_COM(0x00,0xE5); LCD_Write_DATA(0x78,0xF0); // set SRAM internal timing
 611   1              LCD_Write_COM(0x00,0x01); LCD_Write_DATA(0x01,0x00); // set SS and SM bit
 612   1              LCD_Write_COM(0x00,0x02); LCD_Write_DATA(0x07,0x00); // set 1 line inversion
 613   1              LCD_Write_COM(0x00,0x03); LCD_Write_DATA(0x10,0x30); // set GRAM write direction and BGR=1.
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 11  

 614   1              LCD_Write_COM(0x00,0x04); LCD_Write_DATA(0x00,0x00); // Resize register
 615   1              LCD_Write_COM(0x00,0x08); LCD_Write_DATA(0x02,0x07); // set the back porch and front porch
 616   1              LCD_Write_COM(0x00,0x09); LCD_Write_DATA(0x00,0x00); // set non-display area refresh cycle ISC[3:0]
 617   1              LCD_Write_COM(0x00,0x0A); LCD_Write_DATA(0x00,0x00); // FMARK function
 618   1              LCD_Write_COM(0x00,0x0C); LCD_Write_DATA(0x00,0x00); // RGB interface setting
 619   1              LCD_Write_COM(0x00,0x0D); LCD_Write_DATA(0x00,0x00); // Frame marker Position
 620   1              LCD_Write_COM(0x00,0x0F); LCD_Write_DATA(0x00,0x00); // RGB interface polarity
 621   1              //*************Power On sequence ****************//
 622   1              LCD_Write_COM(0x00,0x10); LCD_Write_DATA(0x00,0x00); // SAP, BT[3:0], AP, DSTB, SLP, STB
 623   1              LCD_Write_COM(0x00,0x11); LCD_Write_DATA(0x00,0x07); // DC1[2:0], DC0[2:0], VC[2:0]
 624   1              LCD_Write_COM(0x00,0x12); LCD_Write_DATA(0x00,0x00); // VREG1OUT voltage
 625   1              LCD_Write_COM(0x00,0x13); LCD_Write_DATA(0x00,0x00); // VDV[4:0] for VCOM amplitude
 626   1              LCD_Write_COM(0x00,0x07); LCD_Write_DATA(0x00,0x01);
 627   1              delayms(50); // Dis-charge capacitor power voltage
 628   1              LCD_Write_COM(0x00,0x10); LCD_Write_DATA(0x10,0x90); // 1490//SAP, BT[3:0], AP, DSTB, SLP, STB
 629   1              LCD_Write_COM(0x00,0x11); LCD_Write_DATA(0x02,0x27); // DC1[2:0], DC0[2:0], VC[2:0]
 630   1              delayms(50); // Delay 50ms
 631   1              LCD_Write_COM(0x00,0x12); LCD_Write_DATA(0x00,0x1F); //001C// Internal reference voltage= Vci;
 632   1              delayms(50); // Delay 50ms
 633   1              LCD_Write_COM(0x00,0x13); LCD_Write_DATA(0x15,0x00); //0x1000//1400   Set VDV[4:0] for VCOM amplitude  1A
             -00
 634   1              LCD_Write_COM(0x00,0x29); LCD_Write_DATA(0x00,0x27); //0x0012 //001a  Set VCM[5:0] for VCOMH  //0x0025  0
             -034
 635   1              LCD_Write_COM(0x00,0x2B); LCD_Write_DATA(0x00,0x0D); // Set Frame Rate   000C
 636   1              delayms(50); // Delay 50ms
 637   1              LCD_Write_COM(0x00,0x20); LCD_Write_DATA(0x00,0x00); // GRAM horizontal Address
 638   1              LCD_Write_COM(0x00,0x21); LCD_Write_DATA(0x00,0x00); // GRAM Vertical Address
 639   1              // ----------- Adjust the Gamma Curve ----------//
 640   1              LCD_Write_COM(0x00,0x30); LCD_Write_DATA(0x00,0x00);
 641   1              LCD_Write_COM(0x00,0x31); LCD_Write_DATA(0x07,0x07);
 642   1              LCD_Write_COM(0x00,0x32); LCD_Write_DATA(0x03,0x07);
 643   1              LCD_Write_COM(0x00,0x35); LCD_Write_DATA(0x02,0x00);
 644   1              LCD_Write_COM(0x00,0x36); LCD_Write_DATA(0x00,0x08);//0207
 645   1              LCD_Write_COM(0x00,0x37); LCD_Write_DATA(0x00,0x04);//0306
 646   1              LCD_Write_COM(0x00,0x38); LCD_Write_DATA(0x00,0x00);//0102
 647   1              LCD_Write_COM(0x00,0x39); LCD_Write_DATA(0x07,0x07);//0707
 648   1              LCD_Write_COM(0x00,0x3C); LCD_Write_DATA(0x00,0x02);//0702
 649   1              LCD_Write_COM(0x00,0x3D); LCD_Write_DATA(0x1D,0x04);//1604
 650   1              
 651   1              //------------------ Set GRAM area ---------------//
 652   1              LCD_Write_COM(0x00,0x50); LCD_Write_DATA(0x00,0x00); // Horizontal GRAM Start Address
 653   1              LCD_Write_COM(0x00,0x51); LCD_Write_DATA(0x00,0xEF); // Horizontal GRAM End Address
 654   1              LCD_Write_COM(0x00,0x52); LCD_Write_DATA(0x00,0x00); // Vertical GRAM Start Address
 655   1              LCD_Write_COM(0x00,0x53); LCD_Write_DATA(0x01,0x3F); // Vertical GRAM Start Address
 656   1              LCD_Write_COM(0x00,0x60); LCD_Write_DATA(0xA7,0x00); // Gate Scan Line
 657   1              LCD_Write_COM(0x00,0x61); LCD_Write_DATA(0x00,0x01); // NDL,VLE, REV
 658   1              LCD_Write_COM(0x00,0x6A); LCD_Write_DATA(0x00,0x00); // set scrolling line
 659   1              //-------------- Partial Display Control ---------//
 660   1              LCD_Write_COM(0x00,0x80); LCD_Write_DATA(0x00,0x00);
 661   1              LCD_Write_COM(0x00,0x81); LCD_Write_DATA(0x00,0x00);
 662   1              LCD_Write_COM(0x00,0x82); LCD_Write_DATA(0x00,0x00);
 663   1              LCD_Write_COM(0x00,0x83); LCD_Write_DATA(0x00,0x00);
 664   1              LCD_Write_COM(0x00,0x84); LCD_Write_DATA(0x00,0x00);
 665   1              LCD_Write_COM(0x00,0x85); LCD_Write_DATA(0x00,0x00);
 666   1              //-------------- Panel Control -------------------//
 667   1              LCD_Write_COM(0x00,0x90); LCD_Write_DATA(0x00,0x10);
 668   1              LCD_Write_COM(0x00,0x92); LCD_Write_DATA(0x06,0x00);
 669   1              LCD_Write_COM(0x00,0x07); LCD_Write_DATA(0x01,0x33); // 262K color and display ON
 670   1              LCD_CS =1;  //关闭片选使能
 671   1      
 672   1      }
 673          
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 12  

 674          void Pant(int dcolor)
 675          {
 676   1              int i,j;
 677   1              Address_set(0,0,240,320);
 678   1          for(i=0;i<320;i++)
 679   1               {
 680   2                for (j=0;j<240;j++)
 681   2                      {
 682   3                       LCD_Write_DATA(dcolor>>8,dcolor);
 683   3                  }     
 684   2                }
 685   1      }
 686          void inttostr(int dd,unsigned char *str)
 687          {
 688   1              str[0]=dd/10000+48;
 689   1              str[1]=(dd/1000)-((dd/10000)*10)+48;
 690   1              str[2]=(dd/100)-((dd/1000)*10)+48;
 691   1              str[3]=(dd/10)-((dd/100)*10)+48;
 692   1              str[4]=dd-((dd/10)*10)+48;
 693   1              str[5]=0;
 694   1      }
 695          void AD7843(void)              //外部中断0 用来接受键盘发来的数据
 696          {
 697   1       CS=0;
 698   1      //delayms(1);                     //中断后延时以消除抖动，使得采样数据更准确
 699   1      //while(BUSY);                //如果BUSY信号不好使可以删除不用
 700   1      //delayms(1);
 701   1      WriteCharTo7843(0x90);        //送控制字 10010000 即用差分方式读X坐标 详细请见有关资料
 702   1      //while(BUSY);               //如果BUSY信号不好使可以删除不用
 703   1      //delayms(1);
 704   1      DCLK=1; _nop_();_nop_();_nop_();_nop_();
 705   1      DCLK=0; _nop_();_nop_();_nop_();_nop_();
 706   1      TP_Y=ReadFromCharFrom7843();
 707   1      WriteCharTo7843(0xD0);       //送控制字 11010000 即用差分方式读Y坐标 详细请见有关资料
 708   1      DCLK=1; _nop_();_nop_();_nop_();_nop_();
 709   1      DCLK=0; _nop_();_nop_();_nop_();_nop_();
 710   1      TP_X=ReadFromCharFrom7843();
 711   1      CS=1;
 712   1      }
 713          
 714          //在指定位置显示一个字符(8*12大小)
 715          //dcolor为内容颜色，gbcolor为背静颜色
 716          void showzifu(unsigned int x,unsigned int y,unsigned char value,unsigned int dcolor,unsigned int bgcolor)       
 717          {  
 718   1              unsigned char i,j;
 719   1              unsigned char *temp=zifu;    
 720   1          Address_set(x,y,x+7,y+11); //设置区域      
 721   1              temp+=(value-32)*12;
 722   1              for(j=0;j<12;j++)
 723   1              {
 724   2                      for(i=0;i<8;i++)
 725   2                      {                    
 726   3                              if((*temp&(1<<(7-i)))!=0)
 727   3                              {
 728   4                                      LCD_Write_DATA(dcolor>>8,dcolor);
 729   4                              } 
 730   3                              else
 731   3                              {
 732   4                                      LCD_Write_DATA(bgcolor>>8,bgcolor);
 733   4                              }   
 734   3                      }
 735   2                      temp++;
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 13  

 736   2               }
 737   1      }
 738          //在指定位置显示一个字符串(8*12大小)
 739          //dcolor为内容颜色，gbcolor为背静颜色
 740          void showzifustr(unsigned int x,unsigned int y,unsigned char *str,unsigned int dcolor,unsigned int bgcolor
             -)          
 741          {  
 742   1              unsigned int x1,y1;
 743   1              x1=x;
 744   1              y1=y;
 745   1              while(*str!='\0')
 746   1              {       
 747   2                      showzifu(x1,y1,*str,dcolor,bgcolor);
 748   2                      x1+=7;
 749   2                      str++;
 750   2              }       
 751   1      }
 752          
 753          main()
 754          {
 755   1              unsigned char ss[6];    
 756   1              unsigned int lx,ly;
 757   1              spistar();  //模拟spi初始化
 758   1              LCD_Init();   //tft初始化
 759   1              LCD_CS =0;  //打开LCD片选使能   
 760   1              Pant(0xffff);   //清屏                                  
 761   1          showzifustr(68,5,"GOOD",0,0xffff);  //显示字符串 
 762   1      
 763   1              while(1)
 764   1              {       
 765   2                      if (IRQ==0)
 766   2                      {       
 767   3      
 768   3                              AD7843();
 769   3                              inttostr(TP_X,ss);
 770   3                              showzifustr(10,305,"X:",0xf800,0xffff);
 771   3                              showzifustr(25,305,ss,0xf800,0xffff);   //显示字符串 
 772   3                              inttostr(TP_Y,ss);
 773   3                              showzifustr(80,305,"Y:",0xf800,0xffff);
 774   3                              showzifustr(95,305,ss,0xf800,0xffff);   //显示字符串 
 775   3                              lx=240-((TP_X-400)/13);
 776   3                              ly=320-((TP_Y-400)/10);
 777   3                              Address_set(lx,ly,lx+2,ly+2);
 778   3                              LCD_Write_DATA(0,255);
 779   3                              LCD_Write_DATA(0,255);
 780   3                              LCD_Write_DATA(0,255);
 781   3                              LCD_Write_DATA(0,255);
 782   3                              LCD_Write_DATA(0,255);
 783   3                              LCD_Write_DATA(0,255);
 784   3                              LCD_Write_DATA(0,255);
 785   3                              LCD_Write_DATA(0,255);
 786   3                              LCD_Write_DATA(0,255);
 787   3      
 788   3                      //      delayms(100);
 789   3      
 790   3                      }
 791   2                      else
 792   2                      {
 793   3      
 794   3                      }
 795   2      
 796   2          }
C51 COMPILER V9.00   TEXT1                                                                 05/23/2010 17:59:30 PAGE 14  

 797   1      
 798   1      
 799   1      
 800   1      }
 801          
 802          
 803          
 804          
 805          
 806          
 807          
 808          
 809          
 810          
 811          
 812          
 813          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1509    ----
   CONSTANT SIZE    =   1151    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4      54
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
